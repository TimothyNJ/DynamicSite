# Settings Page Integration Documentation\n\n## Overview\n\nThis document explains how to integrate the universal components into your settings page, replacing the hardcoded main branch elements with configurable, reusable components.\n\n## Integration Process\n\n### 1. Include Required Files\n\nEnsure these files are loaded in your settings page in the correct order:\n\n```html\n<!-- Core Components -->\n<script src=\"/js/core/component-utils.js\"></script>\n<script src=\"/js/core/slider-core.js\"></script>\n<script src=\"/js/core/component-base.js\"></script>\n<script src=\"/js/core/selector-base.js\"></script>\n<script src=\"/js/inputs/input-base.js\"></script>\n\n<!-- Universal Components -->\n<script src=\"/js/components/GenericSelector.js\"></script>\n<script src=\"/js/components/TextInput.js\"></script>\n<script src=\"/js/components/ComponentFactory.js\"></script>\n\n<!-- Settings Integration -->\n<script src=\"/js/pages/settings-components.js\"></script>\n<script src=\"/js/pages/settings-integration.js\"></script>\n```\n\n### 2. HTML Structure\n\nYour HTML should include containers for the original elements:\n\n```html\n<div class=\"settings-container\">\n  <!-- Dynamic components will replace these -->\n  <div id=\"original-selectors\" style=\"display: block\">\n    <!-- Theme Selector -->\n    <div class=\"settings-section\">\n      <div class=\"slider-container theme-container\">\n        <div class=\"slider-selector theme-selector\">\n          <!-- Original hardcoded theme selector -->\n        </div>\n      </div>\n    </div>\n    \n    <!-- Time Format Selector -->\n    <div class=\"settings-section\">\n      <div class=\"slider-container time-format-container\">\n        <div class=\"slider-selector time-format-selector\">\n          <!-- Original hardcoded time format selector -->\n        </div>\n      </div>\n    </div>\n  </div>\n  \n  <div id=\"original-inputs\" style=\"display: block\">\n    <div class=\"settings-section\">\n      <div class=\"form-container\">\n        <div class=\"form-field\">\n          <input type=\"text\" id=\"firstName\" class=\"text-input\" placeholder=\"Enter first name\" />\n        </div>\n        <div class=\"form-field\">\n          <input type=\"text\" id=\"lastName\" class=\"text-input\" placeholder=\"Enter last name\" />\n        </div>\n        <div class=\"form-field\">\n          <input type=\"text\" id=\"nickname\" class=\"text-input\" placeholder=\"Enter nickname (optional)\" />\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n```\n\n### 3. Automatic Integration\n\nThe integration happens automatically when the page loads:\n\n1. Components are registered with their configurations\n2. All components are initialized\n3. Saved values are restored from localStorage\n4. Original hardcoded elements are hidden\n5. Global event listeners are set up\n\n## Component Configurations\n\n### Theme Selector\n```javascript\n{\n  name: 'theme',\n  options: ['dark', 'system', 'light'],\n  labels: ['Dark', 'System Theme', 'Light'],\n  defaultValue: 'dark',\n  storageKey: 'userThemePreference',\n  container: '.theme-selector'\n}\n```\n\n### Time Format Selector\n```javascript\n{\n  name: 'timeFormat',\n  options: ['24', 'system', '12'],\n  labels: ['24h', 'System', '12h'],\n  defaultValue: '24',\n  storageKey: 'userTimeFormatPreference',\n  container: '.time-format-selector'\n}\n```\n\n### Text Inputs\n```javascript\n// First Name\n{\n  id: 'firstName',\n  placeholder: 'Enter first name',\n  storageKey: 'userFirstName',\n  required: true\n}\n\n// Last Name\n{\n  id: 'lastName',\n  placeholder: 'Enter last name',\n  storageKey: 'userLastName',\n  required: true\n}\n\n// Nickname\n{\n  id: 'nickname',\n  placeholder: 'Enter nickname (optional)',\n  storageKey: 'userNickname',\n  validator: TextInput.createValidator('nickname')\n}\n```\n\n## API Reference\n\n### Accessing Component Instances\n\n```javascript\n// Get selector instance\nconst themeSelector = ComponentFactory.getInstance('selector', 'theme');\n\n// Get input instance\nconst firstNameInput = ComponentFactory.getInstance('input', 'firstName');\n```\n\n### Setting Values Programmatically\n\n```javascript\n// Set theme\nthemeSelector.setValue('light');\n\n// Set input value\nfirstNameInput.setValue('John');\n```\n\n### Getting Current Values\n\n```javascript\n// Get theme\nconst currentTheme = themeSelector.currentValue;\n\n// Get input value\nconst firstName = firstNameInput.getValue();\n```\n\n## Event System\n\nThe integration dispatches custom events for each value change:\n\n```javascript\n// Listen for theme changes\ndocument.addEventListener('themeChanged', (event) => {\n  console.log('Theme changed to:', event.detail.theme);\n});\n\n// Listen for input changes\ndocument.addEventListener('firstNameChanged', (event) => {\n  console.log('First name changed to:', event.detail.value);\n});\n```\n\n## Debugging\n\n### Debug Mode\n\nEnable debug mode by adding `?debug=true` to the URL or setting `localStorage.setItem('settingsDebug', 'true')`.\n\nIn debug mode:\n- Detailed console logging\n- Debug panel with controls\n- Test buttons for validation\n\n### Debug Utilities\n\n```javascript\n// Get all component stats\nconst stats = ComponentFactory.getStats();\n\n// Test all components\nwindow.runSettingsIntegrationTests();\n\n// Access individual component debuggers\nwindow.debugThemeSelector.setTheme('light');\nwindow.debugTextInputs.setAllValues({\n  firstName: 'John',\n  lastName: 'Doe',\n  nickname: 'Johnny'\n});\n```\n\n## Fallback Behavior\n\nIf component initialization fails:\n1. Original hardcoded elements remain visible\n2. Basic functionality is preserved\n3. Error messages are logged to console\n4. Retry mechanisms are available\n\n## SPA Support\n\nThe integration handles Single Page Application navigation:\n- Listens for `pageLoaded` events\n- Re-initializes components when navigating to settings\n- Preserves state across navigation\n\n## Testing\n\n### Running Tests\n\n```javascript\n// Run complete integration test suite\nwindow.runSettingsIntegrationTests();\n\n// Run individual component tests\nwindow.testThemeSelector.run();\nwindow.testTimeFormatSelector.run();\nwindow.testTextInputs.run();\n```\n\n### Test Coverage\n\n- Component registration and initialization\n- Value changes and persistence\n- Custom event dispatch\n- localStorage integration\n- SPA navigation handling\n- Error recovery mechanisms\n\n## Best Practices\n\n1. **Always check component availability** before use\n2. **Use the provided event system** for integration\n3. **Test fallback scenarios** during development\n4. **Enable debug mode** for troubleshooting\n5. **Monitor console logs** for warnings/errors\n\n## Troubleshooting\n\n### Common Issues\n\n1. **Components not initializing**\n   - Check if all dependencies are loaded\n   - Verify DOM structure matches expected selectors\n   - Enable debug mode for detailed logging\n\n2. **Values not persisting**\n   - Check localStorage permissions\n   - Verify storage keys are correct\n   - Test in incognito mode\n\n3. **Events not firing**\n   - Ensure event listeners are attached after initialization\n   - Check event names match exactly\n   - Verify components are fully initialized\n\n### Debug Commands\n\n```javascript\n// Check component status\nComponentFactory.getStats();\n\n// Get all registered components\nComponentFactory.getRegistered();\n\n// Clear all storage and restart\nwindow.settingsDebug.clearStorage();\n\n// Show current values\nwindow.debugTextInputs.getAllValues();\n```\n\n## Migration from Main Branch\n\n1. Keep original HTML structure intact\n2. Add the integration scripts\n3. Test that components initialize correctly\n4. Verify all functionality works as expected\n5. Original elements will be automatically hidden\n\n## Future Considerations\n\n- Components are designed to be extensible\n- Easy to add new selectors or inputs\n- Configuration-driven approach allows customization\n- Debug tools help with maintenance\n\nLast Updated: 14-May-2025\n