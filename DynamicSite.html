
<!DOCTYPE html>

<html lang="en">

<head>

<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Dynamic Site 2</title>

<link rel="stylesheet" href="styles.css">

<script>

// Create ResizeObserver to sync buffer widths (content drives navbar)
const bufferResizeObserver = new ResizeObserver(entries => {
    entries.forEach(entry => {
        const leftContentBuffer = document.querySelector('.content-wrapper .content-buffer:first-child');
        const rightContentBuffer = document.querySelector('.content-wrapper .content-buffer:last-child');
        const navbarBuffer1 = document.querySelector('.nav-bar .nav-container:nth-child(1)');
        const navbarBuffer5 = document.querySelector('.nav-bar .nav-container:nth-child(5)');

        if (leftContentBuffer && navbarBuffer1) {
            navbarBuffer1.style.width = getComputedStyle(leftContentBuffer).width;
        }
        if (rightContentBuffer && navbarBuffer5) {
            navbarBuffer5.style.width = getComputedStyle(rightContentBuffer).width;
        }
    });
});

// Start observing content buffers after DOM is loaded
document.addEventListener('DOMContentLoaded', () => {
    const contentBuffers = document.querySelectorAll('.content-wrapper .content-buffer');
    contentBuffers.forEach(buffer => bufferResizeObserver.observe(buffer));
});


// Force reflow on page load to ensure proper layout calculations
window.addEventListener('load', () => {
    document.body.style.display = 'none'; // Temporarily hide body
    document.body.offsetHeight; // Trigger reflow
    document.body.style.display = ''; // Show body again
});


  function switchPage(pageId) {
      // Hide all virtual pages
      const pages = document.querySelectorAll('.virtual-page');
      pages.forEach(page => page.classList.remove('active'));

      // Show the selected page
      const targetPage = document.getElementById(pageId);
      if (targetPage) targetPage.classList.add('active');

      // Update nav button styles
      document.querySelectorAll('.nav-bar .nav-container:nth-child(4) button').forEach(button => button.classList.remove('active'));
      const activeButton = Array.from(document.querySelectorAll('.nav-bar .nav-container:nth-child(4) button')).find(button => button.textContent === pageId);
      if (activeButton) activeButton.classList.add('active');
  }

  document.addEventListener('DOMContentLoaded', () => {
    const collapsedNavbar = document.querySelector('.collapsed-navbar');
    const collapsedMenu = document.querySelector('.collapsed-menu');
    window.isMenuOpenedByClick = false;

    window.addEventListener('resize', () => {
    const collapsedMenu = document.querySelector('.collapsed-menu');
    if (window.innerWidth > parseInt(getComputedStyle(document.documentElement).getPropertyValue('--collapse-breakpoint'))) {
    if (collapsedMenu) {
            collapsedMenu.style.display = 'none';
            collapsedMenu.style.removeProperty('display'); // Remove inline style completely
            window.isMenuOpenedByClick = false;
        }
    }
});

    if (collapsedNavbar && collapsedMenu) {
        // Handle hover events
        collapsedNavbar.addEventListener('mouseenter', () => {
            if (!window.isMenuOpenedByClick) {
                updateMenuContent();
                collapsedMenu.style.display = 'flex';
            }
        });

        collapsedNavbar.addEventListener('mouseleave', () => {
            if (!window.isMenuOpenedByClick) {
                setTimeout(() => {
                    if (!collapsedMenu.matches(':hover')) {
                        collapsedMenu.style.display = 'none';
                    }
                }, 100);
            }
        });

        collapsedMenu.addEventListener('mouseleave', () => {
            if (!window.isMenuOpenedByClick) {
                collapsedMenu.style.display = 'none';
            }
        });

        // Handle click events
        collapsedNavbar.addEventListener('click', (event) => {
            event.stopPropagation();
            if (window.isMenuOpenedByClick) {
                collapsedMenu.style.display = 'none';
                window.isMenuOpenedByClick = false;
            } else {
                updateMenuContent();
                collapsedMenu.style.display = 'flex';
                window.isMenuOpenedByClick = true;
            }
        });

        // Close menu when clicking outside
        document.addEventListener('click', (event) => {
            if (window.isMenuOpenedByClick && !event.target.closest('.collapsed-menu')) {
                collapsedMenu.style.display = 'none';
                window.isMenuOpenedByClick = false;
            }
        });

        // Function to update menu content
        function updateMenuContent() {
            collapsedMenu.innerHTML = '';
            const navContainer = document.querySelector('.nav-container:nth-child(4)');
            const allButtons = navContainer.querySelectorAll('button:not(.collapsed-navbar)');
            
            allButtons.forEach(button => {
                if (!button.classList.contains('active')) {
                    const buttonText = button.querySelector('h3').textContent;
                    const menuButton = document.createElement('button');
                    const h3Element = document.createElement('h3');
                    h3Element.textContent = buttonText;
                    menuButton.appendChild(h3Element);
                    menuButton.onclick = () => {
    switchPage(buttonText);
    setTimeout(() => {
        updateMenuContent();
        collapsedMenu.style.display = 'flex';
    }, 0);
    window.isMenuOpenedByClick = false;
};
                    collapsedMenu.appendChild(menuButton);
                }
            });
        }

        // Initial menu setup
        updateMenuContent();
    }
});




</script>
  
</head>


<script>
  
// Force a reflow on page load to ensure proper layout calculations
window.addEventListener('load', () => {
    document.body.style.display = 'none'; // Temporarily hide body
    document.body.offsetHeight; // Trigger reflow
    document.body.style.display = ''; // Restore body display
    updateDimensions(); // Call updateDimensions after reflow
});

window.addEventListener('resize', updateDimensions);






  </script>
  <script>
    // Force a reflow on page load to ensure proper layout calculations
    window.addEventListener('load', () => {
      document.body.style.display = 'none'; // Temporarily hide body
      document.body.offsetHeight; // Trigger reflow
      document.body.style.display = ''; // Restore body display
      updateDimensions(); // Call updateDimensions after reflow
    });
  
    window.addEventListener('resize', updateDimensions);
  </script>
  
  <script>
    function updateDimensions() {
    // Get navbar3 container dimensions
    const navbar3 = document.querySelector('.nav-bar .nav-container:nth-child(3)');
    const navbar3Dimensions = document.getElementById('navbar3-dimensions');

    if (navbar3 && navbar3Dimensions) {
        const navbar3Width = navbar3.offsetWidth;
        const navbar3Height = navbar3.offsetHeight;
        navbar3Dimensions.textContent = `${navbar3Width}px x ${navbar3Height}px`;
    }

    // Get Home virtual page dimensions
    const homePage = document.getElementById('Home');
    const homeDimensions = document.getElementById('home-dimensions');

    if (homePage && homeDimensions) {
        const homeWidth = homePage.offsetWidth;
        const homeHeight = homePage.offsetHeight;
        homeDimensions.textContent = `${homeWidth}px x ${homeHeight}px`;
    }

    // Get Navbar Buffer 1 dimensions
    const navbarBuffer1 = document.querySelector('.nav-bar .nav-container:nth-child(1)');
    const navbarBuffer1Dimensions = document.getElementById('navbar-buffer1-dimensions');
    if (navbarBuffer1 && navbarBuffer1Dimensions) {
        const buffer1Width = navbarBuffer1.offsetWidth;
        const buffer1Height = navbarBuffer1.offsetHeight;
        navbarBuffer1Dimensions.textContent = `${buffer1Width}px x ${buffer1Height}px`;
    }

    // Get Navbar Buffer 5 dimensions
    const navbarBuffer5 = document.querySelector('.nav-bar .nav-container:nth-child(5)');
    const navbarBuffer5Dimensions = document.getElementById('navbar-buffer5-dimensions');
    if (navbarBuffer5 && navbarBuffer5Dimensions) {
        const buffer5Width = navbarBuffer5.offsetWidth;
        const buffer5Height = navbarBuffer5.offsetHeight;
        navbarBuffer5Dimensions.textContent = `${buffer5Width}px x ${buffer5Height}px`;
    }

    // Get Content Buffer dimensions
    const contentBuffer = document.querySelector('.content-buffer');
    const contentBufferDimensions = document.getElementById('content-buffer-dimensions');
    if (contentBuffer && contentBufferDimensions) {
        const bufferWidth = contentBuffer.offsetWidth;
        const bufferHeight = contentBuffer.offsetHeight;
        contentBufferDimensions.textContent = `${bufferWidth}px x ${bufferHeight}px`;
    }

    // Get navbar4 container
    const navbar4 = document.querySelector('.nav-bar .nav-container:nth-child(4)');
    const navbar = document.querySelector('.nav-bar'); // ✅ Add navbar selection
    const collapsedButton = navbar4.querySelector('.collapsed-navbar');

    // Check if collapsed button is displayed (which happens on smaller screens)
    const isCollapsedButtonVisible = window.getComputedStyle(collapsedButton).display !== 'none';
    if (window.innerWidth > 800) {
    const collapsedMenu = document.querySelector('.collapsed-menu'); 
    if (collapsedMenu) {
        collapsedMenu.style.display = 'none'; // ✅ Hide dropdown
        collapsedMenu.classList.remove('show'); // ✅ Remove any active state
    }
    window.isMenuOpenedByClick = false; // ✅ Ensure dropdown stays toggled off
}


    if (isCollapsedButtonVisible) {
    // Create temporary container
    const tempContainer = document.createElement('div');
        tempContainer.style.position = 'absolute';
        tempContainer.style.left = '-9999px';
        tempContainer.style.visibility = 'hidden';
        document.body.appendChild(tempContainer);

        // Get ALL buttons including collapsed navbar
        const allButtons = navbar4.querySelectorAll('button');
        let maxButtonWidth = 0;
        let widestButton = null;

        // First clone and measure the collapsed navbar button
        const collapsedClone = collapsedButton.cloneNode(true);
        collapsedClone.style.display = 'block';
        collapsedClone.classList.add('active');
        tempContainer.appendChild(collapsedClone);
        const collapsedButtonWidth = collapsedClone.offsetWidth;

        // Then clone and measure all other buttons
        allButtons.forEach(button => {
            if (button !== collapsedButton) { // Skip the original collapsed button as we already measured its clone
                const clone = button.cloneNode(true);
                clone.style.display = 'block'; // Ensure button is measurable
                clone.classList.add('active');
                tempContainer.appendChild(clone);
                const buttonWidth = clone.offsetWidth;
                if (buttonWidth > maxButtonWidth) {
                    maxButtonWidth = buttonWidth;
                    widestButton = button;
                }
            }
        });

        // Clean up temporary container
        document.body.removeChild(tempContainer);

        // Calculate total width by ADDING widest button and collapsed button widths
        const totalWidth = maxButtonWidth + collapsedButtonWidth + 4; // 2px border on each side
        // Set data attribute and class for minimum width
        navbar4.dataset.minWidth = `${totalWidth}px`;
        navbar4.classList.add('enforce-min-width');
        
        // Directly apply the minimum width
        navbar4.style.minWidth = `${totalWidth}px`;
        navbar.style.minWidth = `${totalWidth + 20}px`; // ✅ Apply same width to entire navbar


        // Log both widths and total for debugging
        console.log('Widest regular button:', widestButton ? widestButton.querySelector('h3').textContent : 'none', 'Width:', maxButtonWidth);
        console.log('Collapsed button width:', collapsedButtonWidth);
        console.log('Total width needed:', totalWidth);
    } else {
        // Remove data attribute and class when not needed
        delete navbar4.dataset.minWidth;
        navbar4.classList.remove('enforce-min-width');
        navbar4.style.minWidth = '';
        navbar.style.minWidth = ''; // ✅ Reset navbar width when dropdown is hidden
    }
}
  </script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
        const toggleButton = document.getElementById('border-toggle');
        const siteContainer = document.querySelector('.site-container');
        
        toggleButton.addEventListener('click', function() {
            siteContainer.classList.toggle('borders-hidden');
            // Find all elements containing dimension text
            const dimensionElements = document.querySelectorAll('[id$="-dimensions"]');
            dimensionElements.forEach(element => {
                element.style.display = element.style.display === 'none' ? '' : 'none';
            });
        });
    });
    </script>
  <body>
  

<body>
	<div class="site-container">
	<div class="nav-bar">
	<div class="nav-container"><p id="navbar-buffer1-dimensions"></p></div> <!-- Left buffer -->
	<div class="nav-container"><h1 class="site-title">Dynamic Site Template</h1></div> <!-- NavLeft as Site Title -->
	<div class="nav-container"><p id="navbar3-dimensions"></p> </div> <!-- NavCentre -->
	<div class="nav-container"> <!-- NavRight -->
	<button class="active" onclick="switchPage('Home')"><h3>Home</h3></button>
	<button onclick="switchPage('Create Vendor Request')"><h3>Create Vendor Request</h3></button>
	<button onclick="switchPage('Data Entry Forms')"><h3>Data Entry Forms</h3></button>
	<button onclick="switchPage('Progress View')"><h3>Progress View</h3></button>
    <button class="collapsed-navbar">☰</button>
    <div class="collapsed-menu"></div>
</div>
	<div class="nav-container"><p id="navbar-buffer5-dimensions"></p></div> <!-- Right buffer -->
	</div>
	<div class="content-wrapper">
	<div class="content-buffer"><p id="content-buffer-dimensions"></p></div> <!-- Left content buffer -->
	<div class="content-container">
	<div class="virtual-pages">
	<div class="virtual-page active" id="Home">
    <p id="home-dimensions"></p>
    <h1>H1 Font</h1>
	<h2>H2 Font</h2>
	<h3>H3 Font</h3>
	<p>P Font</p>
	</div>
	<div class="virtual-page" id="Create Vendor Request">
	<h1>Create Vendor Request</h1>
	</div>
	<div class="virtual-page" id="Data Entry Forms">
	<h1>Data Entry Forms</h1>
    </div>
	<div class="virtual-page" id="Progress View">
        <button id="border-toggle" class="border-toggle-btn"><h3>Toggle Size Guides and Borders</h3></button>
        <h1>Progress View</h1>
	</div>
	</div>
	</div>
	<div class="content-buffer"><p id="content-buffer-dimensions"></p></div> <!-- Right content buffer -->
	</div>
	</div>


</body>

</html>
